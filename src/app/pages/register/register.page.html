<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/board"></ion-back-button>
    </ion-buttons>
    <ion-title class="ion-text-center">Registro de Usuario</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-grid fixed>
    <ion-row>
      <ion-col>
        <form #f="ngForm" (ngSubmit)="onSubmit(f)">
          <ion-item>
            <ion-label position="stacked">Nombre</ion-label>
            <ion-input required [(ngModel)]="form.name" name="name"></ion-input>
          </ion-item>
          <ion-item>
            <ion-label position="stacked">Email</ion-label>
            <ion-input required type="email" [(ngModel)]="form.email" name="email"></ion-input>
          </ion-item>
          <ion-item>
            <ion-label position="stacked">Contraseña</ion-label>
            <ion-input required [type]="showPassword ? 'text' : 'password'" [(ngModel)]="form.password" name="password">
            </ion-input>
            <ion-icon slot="end" [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"
              (click)="showPassword = !showPassword" style="cursor:pointer;">
            </ion-icon>
          </ion-item>
          <ion-item>
            <ion-label position="stacked">Repetir Contraseña</ion-label>
            <ion-input required [type]="showConfirmPassword ? 'text' : 'password'" [(ngModel)]="form.confirmPassword"
              name="confirmPassword">
            </ion-input>
            <ion-icon slot="end" [name]="showConfirmPassword ? 'eye-off-outline' : 'eye-outline'"
              (click)="showConfirmPassword = !showConfirmPassword" style="cursor:pointer;">
            </ion-icon>
          </ion-item>
          <ion-text color="danger" *ngIf="form.confirmPassword && !passwordsMatch()">
            <small>Las contraseñas no coinciden</small>
          </ion-text>
          <ion-item>
            <ion-label position="stacked">Rol</ion-label>
            <ion-select [(ngModel)]="form.role" name="role">
              <ion-select-option value="seller">Seller</ion-select-option>
              <ion-select-option value="admin">Admin</ion-select-option>
            </ion-select>
          </ion-item>
          <ion-button expand="full" type="submit" [disabled]="f.invalid || !passwordsMatch() || isLoading">
            {{ isLoading ? 'Registrando...' : 'Registrar' }}
          </ion-button>
        </form>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-toast [isOpen]="showToast" [message]="toastMessage" duration="2000"
    color="{{ toastMessage === 'Usuario creado correctamente' ? 'success' : 'danger' }}"
    (didDismiss)="showToast = false">
  </ion-toast>
</ion-content>